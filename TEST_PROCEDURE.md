# MSW 站點作業系統測試流程

## 測試環境準備

### 步驟 1: 清除舊資料
在瀏覽器開發者工具 Console 執行：
```javascript
localStorage.clear();
window.location.reload();
```

### 步驟 2: 初始化測試帳號
重新載入後，系統會自動建立以下測試帳號：
- **管理員**: `admin` / `admin`
- **主管**: `user002` / `user002`
- **一般員工**: `user001` / `user001`

---

## 測試案例 1: 管理員登入與資料生成

### 1.1 登入管理員帳號
- 帳號: `admin`
- 密碼: `admin`
- **預期結果**: 進入完整後台管理介面（有左側選單）

### 1.2 生成完整測試環境
1. 點擊左側選單「🧪 測試工具」→「模擬中心」
2. 點擊「清除所有模擬資料」
3. 點擊「生成完整測試環境」
4. **預期結果**:
   - 生成 10 位使用者
   - 生成 8 個製程站點
   - 生成 30 個工單
   - 為一般員工自動分配站點

### 1.3 檢查站點配置
1. 點擊左側選單「🏭 MES 製程管理」→「製程站點」
2. **預期結果**: 應該顯示以下 8 個站點：
   - 🧪 除膠站
   - 🔥 烘箱處理
   - 💨 OQC檢驗-釋氣
   - 🔬 OQC檢驗-AOI
   - 🏷️ RFID標籤更換
   - 📦 包裝堆棧
   - 📥 成品入庫
   - 📤 出庫出貨

### 1.4 檢查使用者站點分配
1. 點擊左側選單「⚙️ 系統管理」→「人員管理」
2. 找到一般員工（角色為「一般員工」）
3. 點擊「編輯」
4. **預期結果**: 應該看到「分配站點」區塊，顯示已分配的站點（1-3個）

---

## 測試案例 2: 一般員工登入與站點作業

### 2.1 切換到一般員工帳號
1. 在 Header 右上角的用戶切換下拉選單
2. 選擇一個「一般員工」角色的使用者（例如：桐谷和人、結城明日奈等）
3. 頁面會自動重新載入
4. **預期結果**:
   - 進入簡化的站點作業介面（**無左側選單**、**無上方導航列**）
   - 顯示該員工的主要負責站點名稱
   - 右上角顯示員工姓名和工號

### 2.2 測試站點操作介面結構
**預期介面元素**:
- ✅ 頁面頂部：站點名稱 + 位置資訊
- ✅ 右上角：員工資訊 badge + 登出按鈕
- ✅ 主要工作區：該站點的專屬操作介面
- ✅ 掃描條碼輸入欄位（自動 focus）
- ✅ 工單資訊顯示區
- ✅ 作業資料輸入表單
- ✅ 完成作業按鈕

---

## 測試案例 3: 各站點操作流程測試

### 3.1 除膠站操作
1. 確保當前用戶分配到「除膠站」
2. 在掃描欄位輸入工單編號：`MSW-2025-001`（或任何模擬器生成的工單編號）
3. 按 Enter 或點擊「🔍 查詢」
4. **預期結果**:
   - 顯示工單資訊（工單編號、批次號、濾網類型、數量、來源廠別）
   - 自動填入當前時間到「開始時間」
   - 作業人員欄位顯示當前員工姓名（唯讀）
5. 填寫「完成時間」
6. 點擊「✓ 完成除膠」
7. **預期結果**: 顯示成功提示，表單清空

### 3.2 烘箱處理操作
1. 掃描工單條碼
2. 設定目標溫度：`140` (°C)
3. 設定烘烤時間：`150` (分鐘)
4. 確認開始/完成時間
5. 點擊「✓ 完成烘箱處理」
6. **預期結果**: 工單資料已更新

### 3.3 OQC檢驗-釋氣操作
1. 掃描工單條碼
2. 選擇釋氣檢測結果：「合格」
3. 確認檢驗時間
4. 點擊「✓ 完成檢驗」
5. **預期結果**: 檢驗資料已記錄

### 3.4 OQC檢驗-AOI操作
1. 掃描工單條碼
2. 選擇 AOI 檢測結果：「OK - 無瑕疵」
3. 點擊「✓ 完成 AOI 檢測」
4. **預期結果**: AOI 結果已記錄

### 3.5 RFID標籤更換操作
1. 掃描工單條碼
2. 選擇 RFID 更換狀態：「已更換」
3. 點擊「✓ 完成 RFID 更換」
4. **預期結果**: RFID 狀態已更新

### 3.6 包裝堆棧操作
1. 掃描工單條碼
2. **預期結果**: 自動生成 Pallet ID（格式：`PLT-BATCH-XXXX`）
3. 可手動修改 Pallet ID
4. 填寫包裝完成時間
5. 點擊「✓ 完成包裝」
6. **預期結果**: Pallet ID 已綁定

### 3.7 成品入庫操作
1. 掃描 Pallet ID 或工單條碼
2. 方式一：點擊「🤖 智能分配庫位」
   - **預期結果**: 自動生成庫位編號（例如：`A3-15`）
3. 方式二：手動輸入庫位（例如：`B2-08`）
4. 點擊「✓ 完成入庫」
5. **預期結果**:
   - 工單狀態更新為 `completed`
   - 庫位資訊已記錄

### 3.8 出庫出貨操作
1. 掃描 Pallet ID 或庫位條碼
2. **預期結果**: 顯示庫存資訊
3. 如果尚未入庫，應顯示錯誤訊息：「此批次尚未入庫，無法出貨」
4. 輸入客戶訂單號：`ORD-2025-001`
5. 點擊「✓ 完成出庫」
6. **預期結果**:
   - 工單狀態更新為 `approved`
   - 出貨資訊已記錄

---

## 測試案例 4: 用戶切換功能

### 4.1 管理員切換到員工
1. 登入 `admin`
2. 在 Header 右上角切換到一般員工
3. **預期結果**: 進入站點作業介面

### 4.2 員工切換到管理員
1. 在站點作業介面點擊「登出」
2. 重新登入 `admin`
3. **預期結果**: 進入完整後台管理介面

### 4.3 不同員工切換
1. 登入 `admin`
2. 切換到員工 A（例如：桐谷和人）
3. 記錄該員工的站點
4. 登出後切換到員工 B（例如：結城明日奈）
5. **預期結果**: 顯示不同的站點（如果分配不同）

---

## 測試案例 5: 權限驗證

### 5.1 管理員權限
- ✅ 可訪問所有頁面
- ✅ 可看到所有站點
- ✅ 可編輯所有資料
- ✅ 可生成測試資料

### 5.2 主管權限
- ✅ 可訪問大部分頁面
- ✅ 可看到所有站點
- ✅ 可編輯工單資料

### 5.3 一般員工權限
- ✅ 只能進入站點作業介面
- ✅ 只能看到分配的站點
- ✅ 只能操作工單資料
- ❌ 無法訪問後台管理功能

---

## 測試案例 6: 資料完整性驗證

### 6.1 工單資料流轉
1. 用 admin 登入，到「📋 工單管理」→「工單列表」
2. 選擇一個工單，點擊「查看」
3. **預期結果**:
   - 顯示完整的製程記錄
   - 各站點的作業時間、人員、結果都已記錄

### 6.2 站點統計資料
1. 到「🏭 製程站點管理」
2. **預期結果**:
   - 系統健康狀態：顯示健康站點數/總站點數
   - 各站點類型統計：顯示站點數、運行中數量、使用率

---

## 已知問題與注意事項

### ⚠️ 登入問題
如果登入顯示「帳號不存在」：
1. 開啟開發者工具 Console
2. 執行：`localStorage.clear(); window.location.reload();`
3. 系統會自動建立測試帳號

### ⚠️ 站點不顯示
如果員工登入後看到「無站點權限」：
1. 用 admin 登入
2. 到「模擬中心」重新生成測試環境
3. 確保模擬器為員工分配了站點

### ⚠️ 舊站點名稱
如果看到舊的站點名稱（如「除膠站 A」、「清洗站 B」）：
1. 執行：`localStorage.removeItem('msw_station_data');`
2. 重新載入頁面
3. 站點會自動重新生成為正確名稱

---

## 測試完成檢查清單

- [ ] 管理員可正常登入
- [ ] 測試資料生成成功
- [ ] 8 個站點名稱正確
- [ ] 一般員工登入進入站點作業介面
- [ ] 站點作業介面無左側選單
- [ ] 所有 8 個站點操作介面都已實作
- [ ] 掃描條碼功能正常
- [ ] 工單資料正確顯示
- [ ] 作業記錄成功保存
- [ ] 用戶切換功能正常
- [ ] 權限控制正確

---

## 測試報告範本

```
測試日期: ____________________
測試人員: ____________________

✅ 通過的測試案例:
-

❌ 失敗的測試案例:
-

🐛 發現的問題:
1.

💡 改進建議:
1.
```
